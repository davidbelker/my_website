---
categories:  
- ""    #the front matter should be like the one found in, e.g., blog2.md. It cannot be like the normal Rmd we used
- ""
date: "2021-10-21"
description: GDP components # the title that will show up once someone gets to this page
draft: false
image: gdp.jpg # save picture in \static\img\blogs. Acceptable formats= jpg, jpeg, or png . Your iPhone pics wont work

keywords: ""
slug: tile4 # slug is the shorthand URL address... no spaces plz
title: GDP components
---
  

```{r setup, echo=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  tidy=FALSE,     # display code as typed
  size="small")   # slightly smaller font for code
options(digits = 3)

# default figure size
knitr::opts_chunk$set(
  fig.width=6.75, 
  fig.height=6.75,
  fig.align = "center"
)
```

```{r load-libraries, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(mosaic)
library(ggthemes)
library(GGally)
library(readxl)
library(here)
library(skimr)
library(janitor)
library(broom)
library(tidyquant)
library(infer)
library(openintro)
library(ggrepel)
library(scales) # add to adjust date axis
library(kableExtra)# add for summary statistics
```

# GDP components over time

```{r read_GDP_data, echo=FALSE}

UN_GDP_data  <-  read_excel(here::here("data", "Download-GDPconstant-USD-countries.xlsx"), # Excel filename
                sheet="Download-GDPconstant-USD-countr", # Sheet name
                skip=2) # Number of rows to skip

```

```{r reshape_GDP_data, echo=FALSE}

# transform the data to a tidy format and express figures in billions
tidy_GDP_data  <-  UN_GDP_data %>%
  pivot_longer(col=("1970":"2017"),names_to ="Year",values_to = "Value_in_bn") %>%
  transform(Value_in_bn=Value_in_bn/1e9) %>%
  transform(Year=as.numeric(Year))

# rename the indicators into something shorter
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="Exports of goods and services")] <-"Exports"
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="General government final consumption expenditure")] <-"Government_expenditure"
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="Household consumption expenditure (including Non-profit institutions serving households)")] <-"Household_expenditure"
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="Imports of goods and services")] <-"Imports"
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="Gross Domestic Product (GDP)")] <-"GDP"
tidy_GDP_data$IndicatorName[which(tidy_GDP_data$IndicatorName =="Gross capital formation")] <-"Gross_capital_formation"

# let us compare GDP components for these 3 countries
country_list <- c("United States","India", "Germany")
```




```{r gdp_16, fig.width=9, echo=FALSE}
# create a list for GDP components in the target graph
components_list <- c("Gross_capital_formation","Exports", "Government_expenditure", "Household_expenditure", "Imports")

# filter and transform
tidy_GDP_data %>%
  filter(IndicatorName %in% components_list & Country %in% country_list) %>%
  transform(IndicatorName=factor(IndicatorName, levels = c("Gross_capital_formation","Exports", "Government_expenditure", "Household_expenditure", "Imports"))) %>%
  
  #ggplot
  ggplot(aes(x=Year,y=Value_in_bn))+
  facet_wrap(vars(Country))+
  geom_line(aes(group=IndicatorName,color=IndicatorName))+
  
  #format
  theme_bw()+
  theme(axis.title.x = element_blank())+
  scale_color_hue(name="Components of GDP",
                  labels=c("Gross capital formation","Exports","Government expenditure", "Household expenditure", "Imports"))+
  labs(title = "GDP components over time",
       subtitle = "In constant 2010 USD",
       y = "Billion US$")+
  scale_x_continuous(breaks=seq(1970, 2020, 10))
```

